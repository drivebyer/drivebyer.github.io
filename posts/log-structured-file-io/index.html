<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<title> Log-Structured Storage System &middot; Thinking Cell </title>


<link rel="stylesheet" href="https://drivebyer.github.io/css/slim.css">
<link rel="stylesheet" href="https://drivebyer.github.io/css/highlight.min.css">
<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700|Source+Code+Pro' rel='stylesheet' type='text/css'>

<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
<link rel="shortcut icon" href="/favicon.ico">


<link href="" rel="alternate" type="application/rss+xml" title="Thinking Cell" />

</head>

<body>
  <div class="container">
    <div class="header">
  <h1 class="site-title"><a href="https://drivebyer.github.io/">Thinking Cell</a></h1>
  <p class="site-tagline"></p>
  <div class="nav">
    <a class="nav-btn" href="#">
      <span class="ci ci-burger"></span>
    </a>
    <ul class="nav-list">
       
	  <li class="spacer">&ac;</li>
  
    </ul>
  </div>
</div>
    <div class="content">
      <div class="post">
        <h2 class="post-title"><a href="https://drivebyer.github.io/posts/log-structured-file-io/">Log-Structured Storage System</a></h2>
        <div class="post-content">
          <p>最近在做 PingCAP talent plan 中的课程：<a href="https://github.com/pingcap/talent-plan/blob/master/courses/rust/README.md">TP 201: Practical Networked Applications in Rust</a>（下文简称 PNA）。该课程分为 5 部分，在每部分代码实践开始之前，会有 Building Block，即当前部分的课程资料。目前我学习到了 <a href="https://github.com/pingcap/talent-plan/blob/master/courses/rust/docs/lesson-plan.md#user-content-building-blocks-2">Building Blocks 2</a> ，这部分主要讲怎么将数据以日志的形式记录到磁盘。本篇博客记录了学习过程中的一些阅读心得。</p>
<p>The basic organization of a log structured storage system is, as the name implies, a log - that is, an append-only sequence of data entries. Whenever you have new data to write, instead of finding a location for it on disk, you simply append it to the end of the log.</p>
<p>Log-Structured Storage System（下文简称 LS3）是现在很多数据库在使用的设计理念。LS3 最核心的思路是：当变更（增删改）数据时，将变更数据的操作追加写到日志中，而不是直接修改数据。</p>
<h2 id="project-2">project 2</h2>
<p>In this project you will create a simple on-disk key/value store that can be modified and queried from the command line.</p>
<p>使用 bitcask 算法实现存储，相关术语：</p>
<ul>
<li>command：发送给数据库的命令，类似 SQL</li>
<li>log：磁盘上的 command 序列，顺序与数据库接受顺序一致</li>
<li>log pointer（file offset）：指向磁盘上的一个 log entry</li>
<li>log compaction：删除一个 key 的历史 value 的过程</li>
<li>in-memory index（index）：用来组织 log pointer</li>
<li>index file：Without this， the log would need to be completely replayed to restore the state of the in-memory index each time the database is started.</li>
</ul>
<h2 id="project-3">project 3</h2>
<h2 id="project-4">project 4</h2>
<h2 id="project-5">project 5</h2>
<p>参考资料：</p>
<p>[1]: <strong><a href="http://blog.notdot.net/2009/12/Damn-Cool-Algorithms-Log-structured-storage">Damn Cool Algorithms: Log structured storage</a></strong></p>
<p>[2]: <strong><a href="https://people.eecs.berkeley.edu/~brewer/cs262/LFS.pdf">The Design and Implementation of a Log-Structured File System</a></strong></p>
<p>[3]: <strong><a href="https://github.com/basho/bitcask/blob/develop/doc/bitcask-intro.pdf">Reading: Bitcask: A Log-Structured Hash Table for Fast Key/Value Data</a></strong></p>

        </div>
      </div>
    </div>
    <div class="footer">
  
  <p>Powered by <a href="https://gohugo.io">Hugo</a>. This theme—Slim—is open sourced on <a href="https://github.com/zhe/hugo-theme-slim">Github</a>.</p>
  
</div>

  </div>
  <script src="https://drivebyer.github.io/js/slim.js"></script>
  

</body>

</html>